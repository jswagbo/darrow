(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[785],{9230:function(e,t,r){Promise.resolve().then(r.bind(r,5314))},5314:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return O}});var s=r(9231),i=r(9862),a=r(7662),n=r(5885),l=r(7232),c=r(7253),o=r(4305),d=r(2375),u=r(6589),h=r(3029),g=r(4130),x=r(9481),m=r(5447),p=r(2737),f=r(8098),b=r(3851),v=r(4903),j=r(5213),y=r(9500),w=r(7142),N=r(4934),k=r(5305),A=r(1242),z=r(6144),C=r(9910);function I(e){let{onClick:t,isActive:r,disabled:i,children:a,title:n}=e;return(0,s.jsx)("button",{onClick:t,disabled:i,title:n,className:(0,C.cn)("p-2 rounded transition-colors flex items-center justify-center","hover:bg-silver hover:text-black","disabled:opacity-50 disabled:cursor-not-allowed",r?"bg-silver text-black":"bg-black text-silver border border-silver"),children:a})}function S(e){var t;let{content:r="",onChange:i,placeholder:a="Start typing your document...",className:n,editable:l=!0}=e,c=(0,g.jE)({extensions:[x.Z.configure({heading:{levels:[1,2,3]},bulletList:{keepMarks:!0,keepAttributes:!1},orderedList:{keepMarks:!0,keepAttributes:!1}}),m.Z.configure({types:["heading","paragraph"]})],content:r,onUpdate:e=>{let{editor:t}=e;i(t.getHTML())},editable:l,editorProps:{attributes:{class:(0,C.cn)("prose prose-invert max-w-none","focus:outline-none","min-h-[400px] p-4","text-white bg-black","border border-gray-light rounded-b-lg")}}});return c?(0,s.jsxs)("div",{className:(0,C.cn)("border border-gray-light rounded-lg bg-black",n),children:[(0,s.jsxs)("div",{className:"flex items-center gap-1 p-2 border-b border-gray-light bg-black rounded-t-lg flex-wrap",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1 pr-2 border-r border-gray-light",children:[(0,s.jsx)(I,{onClick:()=>c.chain().focus().toggleBold().run(),isActive:c.isActive("bold"),title:"Bold",children:(0,s.jsx)(p.Z,{size:16})}),(0,s.jsx)(I,{onClick:()=>c.chain().focus().toggleItalic().run(),isActive:c.isActive("italic"),title:"Italic",children:(0,s.jsx)(f.Z,{size:16})}),(0,s.jsx)(I,{onClick:()=>c.chain().focus().toggleStrike().run(),isActive:c.isActive("strike"),title:"Strikethrough",children:(0,s.jsx)(b.Z,{size:16})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1 pr-2 border-r border-gray-light",children:[(0,s.jsx)(I,{onClick:()=>c.chain().focus().toggleBulletList().run(),isActive:c.isActive("bulletList"),title:"Bullet List",children:(0,s.jsx)(v.Z,{size:16})}),(0,s.jsx)(I,{onClick:()=>c.chain().focus().toggleOrderedList().run(),isActive:c.isActive("orderedList"),title:"Numbered List",children:(0,s.jsx)(j.Z,{size:16})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1 pr-2 border-r border-gray-light",children:[(0,s.jsx)(I,{onClick:()=>c.chain().focus().toggleBlockquote().run(),isActive:c.isActive("blockquote"),title:"Quote",children:(0,s.jsx)(y.Z,{size:16})}),(0,s.jsxs)("select",{className:"bg-black text-silver border border-silver rounded px-2 py-1 text-sm",value:c.isActive("heading",{level:1})?"h1":c.isActive("heading",{level:2})?"h2":c.isActive("heading",{level:3})?"h3":"paragraph",onChange:e=>{if("paragraph"===e.target.value)c.chain().focus().setParagraph().run();else{let t=parseInt(e.target.value.replace("h",""));c.chain().focus().toggleHeading({level:t}).run()}},children:[(0,s.jsx)("option",{value:"paragraph",children:"Paragraph"}),(0,s.jsx)("option",{value:"h1",children:"Heading 1"}),(0,s.jsx)("option",{value:"h2",children:"Heading 2"}),(0,s.jsx)("option",{value:"h3",children:"Heading 3"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1 pr-2 border-r border-gray-light",children:[(0,s.jsx)(I,{onClick:()=>c.chain().focus().setTextAlign("left").run(),isActive:c.isActive({textAlign:"left"}),title:"Align Left",children:(0,s.jsx)(w.Z,{size:16})}),(0,s.jsx)(I,{onClick:()=>c.chain().focus().setTextAlign("center").run(),isActive:c.isActive({textAlign:"center"}),title:"Align Center",children:(0,s.jsx)(N.Z,{size:16})}),(0,s.jsx)(I,{onClick:()=>c.chain().focus().setTextAlign("right").run(),isActive:c.isActive({textAlign:"right"}),title:"Align Right",children:(0,s.jsx)(k.Z,{size:16})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(I,{onClick:()=>c.chain().focus().undo().run(),disabled:!c.can().undo(),title:"Undo",children:(0,s.jsx)(A.Z,{size:16})}),(0,s.jsx)(I,{onClick:()=>c.chain().focus().redo().run(),disabled:!c.can().redo(),title:"Redo",children:(0,s.jsx)(z.Z,{size:16})})]})]}),(0,s.jsx)(g.kg,{editor:c,className:"prose prose-invert max-w-none [&_.ProseMirror]:outline-none"}),(0,s.jsxs)("div",{className:"px-4 py-2 text-xs text-gray-light border-t border-gray-light bg-black rounded-b-lg",children:[(null===(t=c.storage.characterCount)||void 0===t?void 0:t.characters())||0," characters"]})]}):(0,s.jsxs)("div",{className:(0,C.cn)("border border-gray-light rounded-lg bg-black",n),children:[(0,s.jsx)("div",{className:"h-12 bg-black border-b border-gray-light rounded-t-lg animate-pulse-silver"}),(0,s.jsx)("div",{className:"min-h-[400px] p-4 animate-pulse-silver"})]})}var L=r(9887),D=r(3176);async function E(e){let{title:t,content:r,docType:s,metadata:i}=e,a=function(e){let t=[];for(let r of e.replace(/<\/p>/g,"</p>\n").replace(/<\/h[1-6]>/g,"</h>\n").split("\n").filter(e=>e.trim())){let e=r.replace(/<[^>]*>/g,"").trim();if(e){if(r.includes("<h1"))t.push(new D.nvN({text:e,heading:D.y5t.HEADING_1,spacing:{after:240}}));else if(r.includes("<h2"))t.push(new D.nvN({text:e,heading:D.y5t.HEADING_2,spacing:{after:200}}));else if(r.includes("<h3"))t.push(new D.nvN({text:e,heading:D.y5t.HEADING_3,spacing:{after:160}}));else{let s=[];r.includes("<strong>")||r.includes("<b>")?s.push(new D.hal({text:e,bold:!0})):r.includes("<em>")||r.includes("<i>")?s.push(new D.hal({text:e,italics:!0})):s.push(new D.hal({text:e})),t.push(new D.nvN({children:s,spacing:{after:120}}))}}}return 0===t.length&&t.push(new D.nvN({children:[new D.hal({text:e.replace(/<[^>]*>/g,"").trim()||"Empty document"})]})),t}(r),n=[new D.nvN({children:[new D.hal({text:t,bold:!0,size:28})],heading:D.y5t.TITLE,alignment:D.B1p.CENTER,spacing:{after:400}}),...a],l=new D.BBB({creator:(null==i?void 0:i.author)||"AI Law Agent",title:t,description:"".concat(s," generated by AI Law Agent"),sections:[{properties:{},children:n}]});return new Uint8Array(await D.UDs.toBuffer(l))}var _=r(8466);async function Z(e){let{title:t,content:r,metadata:s}=e,i=await _.PDFDocument.create();i.setTitle(t),i.setAuthor((null==s?void 0:s.author)||"AI Law Agent"),i.setCreator((null==s?void 0:s.creator)||"AI Law Agent MVP"),i.setProducer((null==s?void 0:s.producer)||"AI Law Agent"),i.setCreationDate((null==s?void 0:s.creationDate)||new Date);let a=await i.embedFont(_.StandardFonts.TimesRoman),n=await i.embedFont(_.StandardFonts.TimesRomanBold),l=i.addPage(),{width:c,height:o}=l.getSize(),d=c-100,u=o-50,h=e=>{u-e<50&&(l=i.addPage(),u=o-50)};h(38),l.drawText(t,{x:50,y:u,size:18,font:n,color:(0,_.rgb)(0,0,0)}),u-=38;let g=r.replace(/<h[1-6][^>]*>/g,"\n\n").replace(/<\/h[1-6]>/g,"\n").replace(/<p[^>]*>/g,"\n").replace(/<\/p>/g,"\n").replace(/<br\s*\/?>/g,"\n").replace(/<strong[^>]*>|<\/strong>/g,"").replace(/<em[^>]*>|<\/em>/g,"").replace(/<[^>]*>/g,"").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').trim().split(/\s+/),x="";for(let e of g){let t=x?"".concat(x," ").concat(e):e;a.widthOfTextAtSize(t,12)<=d?x=t:(x&&(h(14),l.drawText(x,{x:50,y:u,size:12,font:a,color:(0,_.rgb)(0,0,0)}),u-=14),x=e)}x&&(h(14),l.drawText(x,{x:50,y:u,size:12,font:a,color:(0,_.rgb)(0,0,0)}));let m=i.getPages();return m.forEach((e,t)=>{let{width:r}=e.getSize(),s="Page ".concat(t+1," of ").concat(m.length),i=a.widthOfTextAtSize(s,10);e.drawText(s,{x:(r-i)/2,y:30,size:10,font:a,color:(0,_.rgb)(.5,.5,.5)})}),new Uint8Array(await i.save())}function O(){let e=(0,a.useParams)(),t=(0,a.useRouter)(),r=e.id,[g,x]=(0,i.useState)(null),[m,p]=(0,i.useState)(""),[f,b]=(0,i.useState)(""),[v,j]=(0,i.useState)(!0),[y,w]=(0,i.useState)(!1),[N,k]=(0,i.useState)(!1),[A,z]=(0,i.useState)(null),[I,D]=(0,i.useState)(null),[_,O]=(0,i.useState)(!1);(0,i.useEffect)(()=>{(async()=>{let{data:{user:e}}=await L.O.auth.getUser();D(e),e?await T(e.id):t.push("/auth"),j(!1)})()},[r,t]),(0,i.useEffect)(()=>{g&&O(f!==g.title||m!==g.content)},[f,m,g]),(0,i.useEffect)(()=>{let e=e=>{_&&(e.preventDefault(),e.returnValue="")};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[_]);let T=async e=>{try{let{data:t,error:s}=await L.O.from("docs").select("*").eq("id",r).eq("user_id",e).single();if(s)throw s;if(!t){z("Document not found");return}x(t),b(t.title),p(t.content)}catch(e){console.error("Error fetching document:",e),z(e.message||"Failed to load document")}},U=async()=>{if(g&&I){w(!0),z(null);try{let{error:e}=await L.O.from("docs").update({title:f.trim(),content:m,updated_at:new Date().toISOString()}).eq("id",r).eq("user_id",I.id);if(e)throw e;x({...g,title:f.trim(),content:m,updated_at:new Date().toISOString()}),O(!1)}catch(e){console.error("Error saving document:",e),z(e.message||"Failed to save document")}finally{w(!1)}}},F=async()=>{if(g){k(!0);try{let e=await E({title:f.trim(),content:m,docType:g.doc_type,metadata:{author:(null==I?void 0:I.email)||"AI Law Agent User",created:new Date(g.created_at)}});!function(e,t){let r=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),s=URL.createObjectURL(r),i=document.createElement("a");i.href=s,i.download=t.endsWith(".docx")?t:"".concat(t,".docx"),document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(s)}(e,"".concat(f.trim().replace(/\s+/g,"_"),".docx"))}catch(e){console.error("Error exporting DOCX:",e),z(e.message||"Failed to export DOCX")}finally{k(!1)}}},P=async()=>{if(g){k(!0);try{let e=await Z({title:f.trim(),content:m,metadata:{author:(null==I?void 0:I.email)||"AI Law Agent User",creator:"AI Law Agent MVP"}});!function(e,t){let r=new Blob([e],{type:"application/pdf"}),s=URL.createObjectURL(r),i=document.createElement("a");i.href=s,i.download=t.endsWith(".pdf")?t:"".concat(t,".pdf"),document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(s)}(e,"".concat(f.trim().replace(/\s+/g,"_"),".pdf"))}catch(e){console.error("Error exporting PDF:",e),z(e.message||"Failed to export PDF")}finally{k(!1)}}};return v?(0,s.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-pulse-silver text-silver",children:"Loading document..."})}):A&&!g?(0,s.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(l.Z,{className:"mx-auto h-12 w-12 text-red-400 mb-4"}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-white mb-2",children:"Error"}),(0,s.jsx)("p",{className:"text-gray-light mb-6",children:A}),(0,s.jsx)(n.default,{href:"/dashboard",children:(0,s.jsx)(h.z,{variant:"outline",children:"Back to Dashboard"})})]})}):g?(0,s.jsxs)("div",{className:"min-h-screen bg-black",children:[(0,s.jsx)("header",{className:"border-b border-gray-light sticky top-0 bg-black z-10",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex items-center justify-between py-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(n.default,{href:"/dashboard",children:(0,s.jsxs)(h.z,{variant:"ghost",size:"sm",className:"gap-2",children:[(0,s.jsx)(o.Z,{size:16}),"Dashboard"]})}),(0,s.jsx)("div",{className:"border-l border-gray-light pl-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(c.Z,{className:"h-5 w-5 text-silver"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{type:"text",value:f,onChange:e=>b(e.target.value),className:"bg-transparent text-lg font-semibold text-white border-none outline-none focus:ring-2 focus:ring-silver rounded px-2 py-1",placeholder:"Document title..."}),(0,s.jsx)("p",{className:"text-sm text-gray-light",children:(0,C.rh)(g.doc_type)})]})]})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[_&&(0,s.jsx)("span",{className:"text-yellow-400 text-sm",children:"Unsaved changes"}),(0,s.jsxs)(h.z,{onClick:U,disabled:y||!_,variant:"outline",size:"sm",className:"gap-2",children:[(0,s.jsx)(d.Z,{size:16}),y?"Saving...":"Save"]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsxs)(h.z,{onClick:F,disabled:N,size:"sm",className:"gap-2",children:[(0,s.jsx)(u.Z,{size:16}),"DOCX"]}),(0,s.jsxs)(h.z,{onClick:P,disabled:N,variant:"outline",size:"sm",className:"gap-2",children:[(0,s.jsx)(u.Z,{size:16}),"PDF"]})]})]})]})})}),A&&(0,s.jsx)("div",{className:"bg-red-900 border-b border-red-500 px-4 py-3",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto flex items-center gap-2",children:[(0,s.jsx)(l.Z,{size:16,className:"text-red-400"}),(0,s.jsx)("span",{className:"text-red-100",children:A}),(0,s.jsx)(h.z,{variant:"ghost",size:"sm",onClick:()=>z(null),className:"ml-auto text-red-100 hover:text-white",children:"Dismiss"})]})}),(0,s.jsx)("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"card-glossy p-6 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Document Details"}),(0,s.jsxs)("p",{className:"text-gray-light text-sm mt-1",children:["Created ",new Date(g.created_at).toLocaleDateString()," â€¢ Last updated ",new Date(g.updated_at).toLocaleDateString()]})]}),(0,s.jsx)("div",{className:"text-right",children:(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat("completed"===g.status?"bg-green-900 text-green-400":"draft"===g.status?"bg-yellow-900 text-yellow-400":"error"===g.status?"bg-red-900 text-red-400":"bg-gray-900 text-gray-400"),children:g.status.charAt(0).toUpperCase()+g.status.slice(1)})})]})}),(0,s.jsx)(S,{content:m,onChange:p,placeholder:"Start editing your document...",className:"min-h-[600px]"})]})})]}):(0,s.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(c.Z,{className:"mx-auto h-12 w-12 text-gray-light mb-4"}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-white mb-2",children:"Document Not Found"}),(0,s.jsx)("p",{className:"text-gray-light mb-6",children:"The document you're looking for doesn't exist."}),(0,s.jsx)(n.default,{href:"/dashboard",children:(0,s.jsx)(h.z,{variant:"outline",children:"Back to Dashboard"})})]})})}},3029:function(e,t,r){"use strict";r.d(t,{z:function(){return o}});var s=r(9231),i=r(9862),a=r(9802),n=r(4080),l=r(9910);let c=(0,n.j)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",{variants:{variant:{default:"bg-silver text-black hover:bg-gray-light",destructive:"bg-red-500 text-white hover:bg-red-600",outline:"border border-silver text-silver hover:bg-silver hover:text-black",secondary:"bg-gray-800 text-white hover:bg-gray-700",ghost:"hover:bg-silver hover:text-black",link:"underline-offset-4 hover:underline text-silver"},size:{default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-md",lg:"h-11 px-8 rounded-md",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=i.forwardRef((e,t)=>{let{className:r,variant:i,size:n,asChild:o=!1,...d}=e,u=o?a.g7:"button";return(0,s.jsx)(u,{className:(0,l.cn)(c({variant:i,size:n,className:r})),ref:t,...d})});o.displayName="Button"},9887:function(e,t,r){"use strict";r.d(t,{O:function(){return n}});var s=r(8854),i=r(9455);let a="https://ycfwvgsumatjhycpyrqk.supabase.co",n=(0,s.eI)(a,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InljZnd2Z3N1bWF0amh5Y3B5cnFrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTEyNTYxMzIsImV4cCI6MjA2NjgzMjEzMn0.jo33Y2UiF7CPr3lHte-KaHxcf12MXT3kd9QF2auZhzk");(0,s.eI)(a,i.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}})},9910:function(e,t,r){"use strict";r.d(t,{cn:function(){return a},o0:function(){return n},qe:function(){return l},rh:function(){return c}});var s=r(5285),i=r(1078);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,i.m6)((0,s.W)(t))}function n(e){return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(e))}let l={delaware_charter:"Delaware Charter",safe_post:"YC SAFE (Post-Money)",offer_letter:"Offer Letter",rspa:"Restricted Stock Purchase Agreement",board_consent:"Board & Stockholder Consent"};function c(e){return l[e]}}},function(e){e.O(0,[374,834,308,811,746,767,130,540,234,744],function(){return e(e.s=9230)}),_N_E=e.O()}]);